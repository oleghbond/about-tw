<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.1.19" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>Конвертація Google-таблиці у JSON-тідлери: Про Тідлівікі — Посібник для користування Тідлівікі 5+






</title>
</head>
<body class="tc-body">

<section class="tc-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists   tc-tagged-%D0%A1%D1%82%D0%B2%D0%BE%D1%80%D0%B5%D0%BD%D0%BD%D1%8F%20%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D1%96%D0%B2 " data-tags="[[Створення документів]]" data-tiddler-title="Конвертація Google-таблиці у JSON-тідлери"><div class="tc-tiddler-title">
<div class="tc-titlebar">
<span class="tc-tiddler-controls">
<span class=" tc-reveal"><button aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button class="tc-btn-invisible tc-btn-%24%3A%2Fboa%2Fswapbutton">

<span title=""><img src="data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3C!--%20Creator%3A%20CorelDRAW%20X7%20--%3E%0A%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xml%3Aspace%3D%22preserve%22%20width%3D%2245px%22%20height%3D%2230px%22%20version%3D%221.1%22%20style%3D%22shape-rendering%3AgeometricPrecision%3B%20text-rendering%3AgeometricPrecision%3B%20image-rendering%3AoptimizeQuality%3B%20fill-rule%3Aevenodd%3B%20clip-rule%3Aevenodd%22%0AviewBox%3D%220%200%2047%2031%22%0A%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%0A%20%3Cdefs%3E%0A%20%20%3Cstyle%20type%3D%22text%2Fcss%22%3E%0A%20%20%20%3C!%5BCDATA%5B%0A%20%20%20%20.fil0%20%7Bfill%3Alightgrey%7D%0A%20%20%20%5D%5D%3E%0A%20%20%3C%2Fstyle%3E%0A%20%3C%2Fdefs%3E%0A%20%3Cg%20id%3D%22Layer_x0020_1%22%3E%0A%20%20%3Cmetadata%20id%3D%22CorelCorpID_0Corel-Layer%22%2F%3E%0A%20%20%3Cg%20id%3D%22_2205236360080%22%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%20%3Cg%3E%0A%20%20%20%20%20%3Cg%3E%0A%20%20%20%20%20%20%3Cpath%20class%3D%22fil0%22%20d%3D%22M7%2012l22%200c1%2C0%202%2C-1%202%2C-2%200%2C-1%20-1%2C-2%20-2%2C-2l-22%200%204%20-5c1%2C0%201%2C-2%200%2C-2%20-1%2C-1%20-2%2C-1%20-3%2C0l-7%207c0%2C0%20-1%2C0%20-1%2C1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C1%200%2C1%200%2C1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%201%2C0%201%2C0%200%2C0%200%2C0%200%2C0l7%208c1%2C1%202%2C1%203%2C0%201%2C-1%201%2C-2%200%2C-3l-4%20-4z%22%2F%3E%0A%20%20%20%20%20%20%3Cpath%20class%3D%22fil0%22%20d%3D%22M46%2023c1%2C0%201%2C0%201%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C-1%200%2C-1%200%2C-1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C-1%200%2C-1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C-1%200%2C-1%200%2C-1%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%20-1%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0l-7%20-8c-1%2C0%20-2%2C0%20-3%2C0%20-1%2C1%20-1%2C2%200%2C3l4%205%20-22%200c-1%2C0%20-2%2C0%20-2%2C2%200%2C1%201%2C1%202%2C1l22%200%20-4%205c-1%2C1%20-1%2C2%200%2C3%201%2C0%202%2C0%203%2C0l7%20-8c0%2C0%200%2C0%200%2C0%200%2C0%200%2C0%200%2C0z%22%2F%3E%0A%20%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%20%3Cg%3E%0A%20%20%20%3C%2Fg%3E%0A%20%20%3C%2Fg%3E%0A%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"></span>
</button></span>
</span>

<span>

<span class="tc-tiddler-title-icon" style="fill:;">

</span>



<h2 class="tc-title">
Конвертація Google-таблиці у JSON-тідлери
</h2>

</span>

</div>

<div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div>
</div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal">
<div class="tc-subtitle">
<a class="tc-tiddlylink tc-tiddlylink-missing" href=".html">

</a> 11-5-2019
</div>
</div>
<div class=" tc-reveal">
<div class="tc-tags-wrapper"><span class="tc-tag-list-item">
<span class="tc-tag-label tc-btn-invisible" draggable="true" style="background-color:;
fill:#333333;
color:#333333;">
 Створення документів
</span>
<span class="tc-drop-down tc-reveal" hidden="true"></span></span></div>
</div>

<div class="tc-tiddler-body tc-reveal"><p>Зміст будь-якої Тідлівікі за своєю структурою даних представляє двовимірну (<a class="tc-tiddlylink tc-tiddlylink-missing" href="CxR.html">CxR</a>) таблицю, де колонками (c) є поля (<code>title</code>, <code>text</code>, <code>tags</code>, <code>type</code> тощо), а рядками (r) окремі тідлери. Ця таблиця, з урахуванням прихованих і системних тідлерів, доволі проріджена і, тому, природним її представленням є JSON-формат.</p><p>Той же JSON-формат також природно представляє вміст Google-таблиць. </p><p>Отже ця стаття описує простий спосіб перетворення (конвертації) Google-таблиці у набір тідлерів у JSON-форматі. </p><p>За основу метода взята розробка <a class="tc-tiddlylink-external" href="https://www.npmjs.com/~bassarisse" rel="noopener noreferrer" target="_blank">Bruno Assarisse</a> під назвою <a class="tc-tiddlylink-external" href="https://www.npmjs.com/package/google-spreadsheet-to-json" rel="noopener noreferrer" target="_blank">google-spreadsheet-to-json</a>. Це простий інструмент для експорту електронних Google-таблиць до JSON-файлів, що можна використовувати або під Node API, або як CLI (з командного рядка операційної системи).</p><p>Установка конвертера з командного рядка відбувається таким чином:</p><pre><code>  $ npm install -g google-spreadsheet-to-json</code></pre><p>Конвертер <code>gsjson</code> використовується через запуск з параметрами:</p><pre><code>  $ gsjson &lt;spreadsheet-id&gt; [file] [options]</code></pre><p>Тут представлена таблиця значень деяких параметрів запуску ковертера <code>gsjson</code>, що будуть корисними саме для створення JSON-тідлерів.</p><table><tbody><tr class="evenRow"><th colspan="2">Параметр</th><th rowspan="2" valign="center">Дія</th></tr><tr class="oddRow"><th>Скорочено</th><th>Повністю</th></tr><tr class="evenRow"><td align="center" valign="top">-h</td><td align="left" valign="top">–help</td><td align="left" valign="top">вивести інформацію про використання</td></tr><tr class="oddRow"><td align="center" valign="top">-b</td><td align="left" valign="top">–beautify</td><td align="left" valign="top">вивести остаточний JSON-файл з відступами</td></tr><tr class="evenRow"><td align="center" valign="top">-w</td><td align="left" valign="top">–worksheet &lt;n&gt;</td><td align="left" valign="top">індекс робочого аркуша (рахується з нуля) або<br>назва (за умовчанням назва першого аркуша,<br>можна повторити)</td></tr><tr class="oddRow"><td align="center" valign="top">-m</td><td align="left" valign="top">–property-mode &lt;mode&gt;</td><td align="left" valign="top">як обробляти імена властивостей: &quot;camel&quot; (за<br>замовчуванням), &quot;pascal&quot;, &quot;nospace&quot; або &quot;none&quot;</td></tr><tr class="evenRow"><td align="center" valign="top">-i</td><td align="left" valign="top">–vertical</td><td align="left" valign="top">використовувати перший стовпець як заголовок</td></tr></tbody></table><p>Для простоти розглянемо конвертацію Google-таблиці, опублікованої для всіх. Для цього попередньо в меню Google-таблиці виберемо <code>Файл</code> / <code>Опублікувати в Інтернеті...</code> Далі у діалоговому вікні виберемо <code>Увесь документ</code> і <code>Веб-сторінка</code> і натиснемо кнопку <code>Опублікувати</code>. Google-таблиця готова до конвертації.</p><p>У якості прикладу візьмемо Google-таблицю, що знаходиться за веб-адресою:</p><pre><code>https://docs.google.com/spreadsheets/d/abcdfg1234/edit</code></pre><p>У другому аркуші <code>Аркуш2</code> цієї таблиці маємо такий вміст (3х3):</p><table><tbody><tr class="evenRow"><td align="left" valign="top">TITLE</td><td align="left" valign="top">PUBLISHED BY</td><td align="left" valign="top">TEXT</td></tr><tr class="oddRow"><td align="left" valign="top">FET-Open project SUMCASTEC workshop on biomedical <br>applications of electromagnetic energy</td><td align="left" valign="top">Anonymous</td><td align="left" valign="top">Venue:<br>The Bath Royal Literary<br>Achievements<br>FET-Open project SUMCASTEC workshop&quot;</td></tr><tr class="evenRow"><td align="left" valign="top">Launch of the European Black Sea Strategic Research</td><td align="left" valign="top">Anonymous</td><td align="left" valign="top">News<br>Launch of the European Black Sea Strategic Research and Innovation Agenda<br>Wednesday, 8 May, 2019</td></tr></tbody></table><p>Зверніть увагу на обов'язковість двох заголовків <code>TITLE</code> і <code>TEXT</code>, що відповідають назві і текстовому вмісту тідлерів.</p><p>Для конвертації таблиці до JSON-формату запускаємо команду:</p><pre><code>  $ gsjson abcdfg1234 data.json -b -w 1</code></pre><p>Значення параметрів цієї команди мають такий смисл:</p><ul><li><code>abcdfg1234</code> - хеш-індекс Google-таблиці, взятий з її веб-адреси вище;</li><li><code>data.json</code> - ім'я кінцевого JSON-файлу;</li><li><code>-b</code> - красиве форматування JSON-файлу з відступами;</li><li><code>-w 1</code> - конвертуємо другий аркуш таблиці.</li></ul><p>У підсумку отриманий файл <code>data.json</code> матиме такий вміст:</p><pre><code>[
    {
        &quot;title&quot;: &quot;FET-Open project SUMCASTEC workshop&quot;,
        &quot;publishedBy&quot;: &quot;Anonymous&quot;,
        &quot;text&quot;: &quot;Venue: \nThe Bath Royal Literary\nAchievements\nFET-Open project SUMCASTEC workshop&quot;
    },
    {
        &quot;title&quot;: &quot;Launch of the European Black Sea Strategic Research&quot;,
        &quot;publishedBy&quot;: &quot;Anonymous&quot;,
        &quot;text&quot;: &quot;News\nLaunch of the European Black Sea Strategic Research and Innovation Agenda\nWednesday, 8 May, 2019&quot;
    }
]</code></pre><p>В основному це все. Отриманий файл <code>data.json</code> перетягуємо мишею до Тідлівікі і маємо два нових тідлери.</p></div>



</div>

</p>
</section>
</body>
</html>
